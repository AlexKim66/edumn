<template>
    <div class="element-preview ve-column">
        <h1>{{type}}</h1>
        <Input v-model="title" placeholder="Нэр оруулна уу..." style="width: 300px" @on-change="changeTitle"></Input>
        <Button type="success" @click="save">Хадгалах</Button>

        <component :is="elementType" v-bind="currentProperties"></component>
    </div>
</template>

<script>
import axios from "axios";
import { mapGetters } from "vuex";

import AreaLine from "./AreaLine";
import Pie from "./Pie";
import TableE from "./Table";
import Radar from "./Radar";
import CountBox from "./CountBox";

export default {
    methods: {
        save() {
            this.$emit("saveSchema", this.title, this.currentProperties);
        },
        changeTitle(e) {
            this.$store.commit("setTitle", e.target.value);
        }
    },
    data() {
        return {};
    },
    mounted() {},
    components: {
        AreaChart: AreaLine,
        LineChart: AreaLine,
        ColumnChart: AreaLine,
        PieChart: Pie,
        TreeMapChart: Pie,
        FunnelChart: Pie,
        DataTable: TableE,
        RadarChart: Radar,
        CountBox: CountBox,
        /*
                    'AreaLine': () => import('./AreaLine.vue'),
                    'Pie': () => import('./Pie.vue'),
                    'TableE': () => import('./Table.vue'),
                    'Radar': () => import('./Radar.vue')*/
    },
    computed: {
        ...mapGetters({
            elementTypes: "elementTypes",
            elementType: "elementType",
            data: "data",
            areaLineColumnFields: "areaLineColumnFields",
            pieColumnFields: "pieColumnFields",
            tableFields: "tableFields",
            radarFields: "radarFields",
            CountBoxData: "countBox",
            title: "title",
            table: "table",
        }),
        currentProperties() {
            if (
                this.elementType === "AreaChart" ||
                this.elementType === "LineChart" ||
                this.elementType === "ColumnChart"
            ) {
                return {
                    axis: this.areaLineColumnFields.axis,
                    lines: this.areaLineColumnFields.lines,
                    type: this.elementType,
                    chart_title: this.title,
                    table: this.table
                };
            }
            if (
                this.elementType === "PieChart" ||
                this.elementType === "FunnelChart" ||
                this.elementType === "TreeMapChart"
            ) {
                return {
                    value: this.pieColumnFields.value,
                    title: this.pieColumnFields.title,
                    type: this.elementType,
                    chart_title: this.title,
                    table: this.table
                };
            }
            if (this.elementType === "DataTable") {
                return {
                    values: this.tableFields.values,
                    type: this.elementType,
                    chart_title: this.title,
                    table: this.table
                };
            }
            if (this.elementType === "RadarChart") {
                return {
                    values: this.radarFields.values,
                    type: this.elementType,
                    chart_title: this.title,
                    table: this.table
                };
            }
            if (this.elementType === "countBox") {

                return {
                    bgColor: this.CountBoxData.bgColor,
                    countFields: this.CountBoxData.countFields,
                    icon: this.CountBoxData.icon,
                    link: this.CountBoxData.link,
                    linkTitle: this.CountBoxData.linkTitle,
                    textColor: this.CountBoxData.textColor,
                    type: this.elementType,
                    chart_title: this.title,
                    table: this.table
                };
            }
        }
    }
};
</script>
