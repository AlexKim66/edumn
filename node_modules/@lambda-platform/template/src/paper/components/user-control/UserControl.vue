<template>
    <div class="user-control">
        <ul>
            <li class="paper-notification">
                <notif-widget :user="$user.id"/>
            </li>

            <li class="avatar-item">
                <Poptip placement="bottom-end" popper-class="no-animation">
                    <a href="javascript:void(0)" class="avatar">
                        <img src="/assets/lambda/images/avatar.png" alt="avatar">
                        <span>{{ $user.first_name ? $user.first_name : $user.login }} {{$user.org_id?'/':''}} {{$user.org_id?$user.org_id:''}}</span>
                    </a>
                    <div class="header-profile" slot="content">
                        <div class="header-profile-info">
                            <h3>{{ $user.login }} </h3>
                            <small>{{$user.org_id?$user.org_id:$static_words ? $static_words.signedUser : 'Нэвтэрсэн хэрэглэгч'}}</small>
                        </div>
                        <ul>
                            <li>
                                <router-link to="/module/profile">
                                    <Icon type="ios-contact-outline"/>
                                    <span v-if="$static_words">{{$static_words.profile}}</span>
                                    <span v-else>Хувийн мэдээлэл</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/module/password">
                                    <Icon type="ios-key-outline"/>
                                    <span v-if="$static_words">{{$static_words.changePassword}}</span>
                                    <span v-else>Нууц үг солих</span>
                                </router-link>
                            </li>
                            <li v-if="$user.role==1 || $user.role==29">
                                <a href="/lambda/puzzle" target="_blank">
                                    <Icon type="ios-settings-outline"/>
                                    <span v-if="$static_words">{{$static_words.superAdmin}}</span>
                                    <span v-else>Сүпер админ удирдлага</span>
                                </a>
                            </li>
                            <li>
                                <a @click="logoutModal = true">
                                    <Icon type="ios-log-out"/>
                                    <span v-if="$static_words">{{$static_words.logout}}</span>
                                    <span v-else>Системээс гарах</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </Poptip>
            </li>

            <slot name="right">
            </slot>

        </ul>

        <Modal v-model="logoutModal" :closable="false" width="252" class="logout-modal">
            <p slot="header" style="display:none;"></p>
            <div style="text-align:center">
                <a @click="logout()">
                    <Icon type="md-log-out"/>
                    <span v-if="$static_words">{{$static_words.logout}}</span>
                    <span v-else>Гарах</span>
                </a>
                <a @click="cancel()">
                    <Icon type="md-refresh"/>
                    <span v-if="$static_words">{{$static_words.cancel}}</span>
                    <span v-else>Гарах</span>
                </a>
            </div>
            <div slot="footer" style="display:none;">
                <form action="/auth/logout"></form>
            </div>
        </Modal>
    </div>
</template>

<script>
    export default {
        name: "UserControl",
        data() {
            return {
                logoutModal: false,
                poptipOption: {
                    animation: 'none',
                    modifiers: {
                        computeStyle: {
                            gpuAcceleration: false,
                        },
                        preventOverflow: {
                            boundariesElement: 'window'
                        }
                    }
                },
                scrollOptions: {
                    height: '100%',
                    size: 7,
                    alwaysVisible: true,
                    wheelStep: 5,
                    color: '#2C3A47'
                },

            };
        },
        mounted() {
            console.log(this.$static_words);
        },
        methods: {
            logout() {
                axios.post("/auth/logout", {}).then(o => {
                    window.location = "/auth/login";
                });
            },
            cancel() {
                this.$data.logoutModal = false;
            }
        }
    }
</script>

<style lang="scss">
    @import "./UserControl";
</style>
